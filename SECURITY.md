# Security Policy

## Threat Model

We assume the Nexus-RTB engine operates in a hostile environment where:

1.  **External Input (Bid Requests)** is untrusted and potentially malicious.
2.  **Model Artifacts** could be tampered with if the S3 bucket/storage is compromised.
3.  **Budget Control** is critical; failure leads to financial loss.

## Vulnerability Mitigation

| Threat             | Surface            | Mitigation Strategy                                                                                                                                     |
| ------------------ | ------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **RCE via Pickle** | `ModelLoader`      | **Fail-Closed Signature verification**. The engine actively refuses to load `*.pkl` files without a valid `*.sig` generated by the offline signing key. |
| **DoS (Memory)**   | `BidRequest`       | **Input Truncation**. All string inputs (UA, URL) are truncated to 512 chars before hashing. Strict Pydantic types enforce schema.                      |
| **Budget Drain**   | `PacingController` | **Fail-Safe Defaults**. If Redis is unreachable, the pacer falls back to a conservative local limit. 5ms timeout prevents thread starvation.            |
| **Data Poisoning** | `Training`         | **Outlier detection**. Updates with erratic gradients are discarded.                                                                                    |

## Secure Development Lifecycle (SDLC)

1.  **Dependencies**: All packages pinned in `requirements.txt` with hashes (future work).
2.  **Secrets**: No hardcoded API keys. Configuration via `os.environ` only.
3.  **Images**: Distroless or Slim Docker images to reduce attack surface.

## Reporting a Vulnerability

Please report security issues to `security-team@nexus-rtb.internal` (Mock).
**DO NOT** create public GitHub issues for security vulnerabilities.

---

_Last Audit: February 2026_
